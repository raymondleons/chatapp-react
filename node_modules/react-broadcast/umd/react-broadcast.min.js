!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e(t.ReactBroadcast={},t.React)}(this,function(t,e){"use strict";function n(t){return function(){return t}}function r(t){var e=[],n=t;return{getState:function(){return n},setState:function(t){n=t,e.forEach(function(t){return t(n)})},subscribe:function(t){return e.push(t),function(){return e=e.filter(function(e){return e!==t})}}}}e=e&&e.hasOwnProperty("default")?e.default:e;var o=function(){};o.thatReturns=n,o.thatReturnsFalse=n(!1),o.thatReturnsTrue=n(!0),o.thatReturnsNull=n(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(t){return t};var i=o,a=function(t,e,n,r,o,i,a,c){if(!t){var s;if(void 0===e)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,o,i,a,c],p=0;(s=new Error(e.replace(/%s/g,function(){return u[p++]}))).name="Invariant Violation"}throw s.framesToPop=1,s}},c="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",s=function(){function t(t,e,n,r,o,i){i!==c&&a(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e};return n.checkPropTypes=i,n.PropTypes=n,n},u=function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t){t.exports=s()}),p=function(t,e,n,r,o,i,a,c){if(!t){var s;if(void 0===e)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,o,i,a,c],p=0;(s=new Error(e.replace(/%s/g,function(){return u[p++]}))).name="Invariant Violation"}throw s.framesToPop=1,s}},f=(function(){function t(t){this.value=t}function e(e){function n(o,i){try{var a=e[o](i),c=a.value;c instanceof t?Promise.resolve(c.value).then(function(t){n("next",t)},function(t){n("throw",t)}):r(a.done?"return":"normal",a.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(t,e){return new Promise(function(r,a){var c={key:t,arg:e,resolve:r,reject:a,next:null};i?i=i.next=c:(o=i=c,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},h=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},d=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},y=function(t){function n(){var e,o,i;f(this,n);for(var a=arguments.length,c=Array(a),s=0;s<a;s++)c[s]=arguments[s];return e=o=d(this,t.call.apply(t,[this].concat(c))),o.broadcast=r(o.props.value),i=e,d(o,i)}return h(n,t),n.prototype.getChildContext=function(){var t;return{broadcasts:l({},this.context.broadcasts,(t={},t[this.props.channel]=this.broadcast,t))}},n.prototype.componentWillReceiveProps=function(t){this.props.channel!==t.channel&&("production"!==process.env.NODE_ENV?p(!1,"You cannot change <Broadcast channel>"):p(!1)),this.props.value!==t.value&&this.broadcast.setState(t.value)},n.prototype.render=function(){return e.Children.only(this.props.children)},n}(e.Component);y.contextTypes={broadcasts:u.object},y.childContextTypes={broadcasts:u.object.isRequired};var v=function(t){function e(){var n,r,o;f(this,e);for(var i=arguments.length,a=Array(i),c=0;c<i;c++)a[c]=arguments[c];return n=r=d(this,t.call.apply(t,[this].concat(a))),r.state={value:null},o=n,d(r,o)}return h(e,t),e.prototype.getBroadcast=function(){var t=(this.context.broadcasts||{})[this.props.channel];return t||("production"!==process.env.NODE_ENV?p(!1,'<Subscriber channel="%s"> must be rendered in the context of a <Broadcast channel="%s">',this.props.channel,this.props.channel):p(!1)),t},e.prototype.componentWillMount=function(){this.setState({value:this.getBroadcast().getState()})},e.prototype.componentDidMount=function(){var t=this;this.unsubscribe=this.getBroadcast().subscribe(function(e){t.setState({value:e})})},e.prototype.componentWillUnmount=function(){this.unsubscribe()},e.prototype.render=function(){return this.props.children(this.state.value)},e}(e.Component);v.contextTypes={broadcasts:u.object},t.Broadcast=y,t.Subscriber=v,Object.defineProperty(t,"__esModule",{value:!0})});
